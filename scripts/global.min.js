"use strict";function addLoadEvent(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t(),e()}}function insertAfter(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)}function addClass(e,t){if(e.className){var n=e.className;n+=" ",n+=t,e.className=n}else e.className=t}function highlightPage(){if(!document.getElementById)return!1;if(!document.getElementsByTagName)return!1;var e=document.getElementsByTagName("header");if(0==e.length)return!1;var t=e[0].getElementsByTagName("nav");if(0==t.length)return!1;for(var n,r=t[0].getElementsByTagName("a"),a=0;a<r.length;a++)if(n=r[a].getAttribute("href"),-1!=window.location.href.indexOf(n)){r[a].className="here";var i=r[a].lastChild.nodeValue.toLowerCase();document.body.setAttribute("id",i)}}function moveElement(e,t,n,r){if(!document.getElementById)return!1;if(!document.getElementById(e))return!1;var a=document.getElementById(e);a.movement&&clearTimeout(a.movement),a.style.left||(a.style.left="0px"),a.style.top||(a.style.top="0px");var i=parseInt(a.style.left),l=parseInt(a.style.top),o=0;if(i==t&&l==n)return!0;i<t&&(o=Math.ceil((t-i)/10),i+=o),i>t&&(o=Math.ceil((i-t)/10),i-=o),l<n&&(o=Math.ceil((n-l)/10),l+=o),l>n&&(o=Math.ceil((l-n)/10),l-=o),a.style.left=i+"px",a.style.top=l+"px";var d="moveElement('"+e+"' , "+t+" , "+n+" , "+r+")";a.movement=setTimeout(d,r)}function prepareSlideshow(){if(!document.getElementById)return!1;if(!document.getElementById("intro"))return!1;if(!document.getElementsByTagName)return!1;var e=document.createElement("div");e.setAttribute("id","slideshow");var t=document.createElement("img");t.setAttribute("id","preview"),t.setAttribute("src","images/slideshow.gif"),t.setAttribute("alt","Jay Skript slideshow"),e.appendChild(t),insertAfter(e,document.getElementById("intro"));var n=document.createElement("img");n.setAttribute("id","frame"),n.setAttribute("src","images/frame.gif"),n.setAttribute("alt",""),e.appendChild(n);for(var r,a=document.getElementsByTagName("a"),i=0;i<a.length;i++)a[i].onmouseover=function(){r=this.getAttribute("href"),-1!=r.indexOf("index.html")&&moveElement("preview",0,0,5),-1!=r.indexOf("about.html")&&moveElement("preview",-150,0,5),-1!=r.indexOf("photos.html")&&moveElement("preview",-300,0,5),-1!=r.indexOf("live.html")&&moveElement("preview",-450,0,5),-1!=r.indexOf("contact.html")&&moveElement("preview",-600,0,5)}}function showSection(e){for(var t=document.getElementsByTagName("section"),n=0;n<t.length;n++)t[n].getAttribute("id")!=e?t[n].style.display="none":t[n].style.display="block"}function prepareInternalnav(){if(!document.getElementsByTagName)return!1;if(!document.getElementById)return!1;var e=document.getElementsByTagName("article");if(0==e.length)return!1;var t=e[0].getElementsByTagName("nav");if(0==t.length)return!1;for(var n=t[0],r=n.getElementsByTagName("a"),a=0;a<r.length;a++){var i=r[a].getAttribute("href").split("#")[1];document.getElementById(i)&&(document.getElementById(i).style.display="none",r[a].destination=i,r[a].onclick=function(){return console.log(this),showSection(this.destination),!1})}}function preparePlaceholder(){if(!document.createElement)return!1;if(!document.createTextNode)return!1;if(!document.getElementById)return!1;if(!document.getElementById("imagegallery"))return!1;var e=document.createElement("div");e.setAttribute("class","swap");var t=document.createElement("img");t.setAttribute("id","placeholder"),t.setAttribute("src","images/placeholder.gif"),t.setAttribute("alt","my image gallery"),t.setAttribute("title","my image gallery");var n=document.createElement("p");n.setAttribute("id","description");var r=document.createTextNode("图片说明");n.appendChild(r),insertAfter(e,document.getElementById("imagegallery")),e.appendChild(t),insertAfter(n,t)}function showPic(e){var t=e.getAttribute("href");if(document.getElementById("placeholder").setAttribute("src",t),e.getAttribute("title"))var n=e.getAttribute("title");else var n="";var r=document.getElementById("description");return 3==r.firstChild.nodeType&&(r.firstChild.nodeValue=n),!1}function prepareGallery(){if(!document.getElementById("imagegallery"))return!1;for(var e=document.getElementById("imagegallery"),t=e.getElementsByTagName("a"),n=0;n<t.length;n++)t[n].onclick=function(){return showPic(this)}}function stripeTables(){if(!document.getElementsByTagName)return!1;for(var e=document.getElementsByTagName("table"),t=0;t<e.length;t++)for(var n=!1,r=e[t].getElementsByTagName("tr"),a=0;a<r.length;a++)1==n?(addClass(r[a],"odd"),n=!1):n=!0}function highlightRows(){if(!document.getElementsByTagName)return!1;for(var e=document.getElementsByTagName("tr"),t=0;t<e.length;t++)e[t].oldClassName=e[t].className,e[t].onmouseover=function(){addClass(this,"highlight")},e[t].onmouseout=function(){this.className=this.oldClassName}}function displayAbbreviations(){if(!document.getElementsByTagName||!document.createElement||!document.createTextNode)return!1;var e=document.getElementsByTagName("abbr");if(e.length<1)return!1;for(var t=new Array,n=0;n<e.length;n++){var r=e[n];if(!(r.childNodes.length<1)){var a=r.getAttribute("title"),i=r.lastChild.nodeValue;t[i]=a}}var l=document.createElement("dl");for(i in t){var a=t[i],o=document.createElement("dt"),d=document.createTextNode(i);o.appendChild(d);var m=document.createElement("dd"),s=document.createTextNode(a);m.appendChild(s),l.appendChild(o),l.appendChild(m)}if(l.childNodes.length<1)return!1;var u=document.createElement("h3"),c=document.createTextNode("Abbreviations");u.appendChild(c);var g=document.getElementsByTagName("article");if(0==g.length)return!1;var f=g[0];f.appendChild(u),f.appendChild(l)}function focusLabels(){if(document.getElementsByTagName)return!1;for(var e=document.getElementsByTagName("label"),t=0;t<e.length;t++)label[t].getAttribute("for")&&(e[t].onclick=function(){var e=this.getAttribute("for");if(!document.getElementById)return!1;document.getElementById(e).focus()})}function resetFields(e){for(var t=0;t<e.elements.length;t++){var n=e.elements[t];if("submit"!=n.type){(n.placeholder||n.getAttribute("placeholder"))&&(n.onfocus=function(){var e=this.placeholder||this.getAttribute("placeholder");this.value==e&&(this.className="",this.value="")},n.onblur=function(){""==this.value&&(this.className="placeholder",this.value=this.placeholder||this.getAttribute("placeholder"))},n.onblur())}}}function prepareForms(){for(var e=0;e<document.forms.length;e++){var t=document.forms[e];resetFields(t),t.onsubmit=function(){return!!validateForm(this)&&!submitFormWithAjax(this,document.getElementsByTagName("article")[0])}}}function isFilled(e){if(0==e.value.replace(" ","").length)return!1;var t=e.placeholder||e.getAttribute("placeholder");return e.value!=t}function isEmail(e){return-1!=e.value.indexOf("@")&&-1!=e.value.indexOf(".")}function validateForm(e){for(var t=0;t<e.elements.length;t++){var n=e.elements[t];if("required"==n.required&&!isFilled(n))return alert("Please fill in the "+n.name+" field."),!1;if("email"==n.type&&!isEmail(n))return alert("The "+n.name+" field must be a valid email address."),!1}return!0}function getHTTPObject(){return"undefined"==typeof XMLHttpRequest&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}),new XMLHttpRequest}function displayAjaxLoading(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild);var t=document.createElement("img");t.setAttribute("src","images/loading.gif"),t.setAttribute("alt","Loading"),e.appendChild(t)}function submitFormWithAjax(e,t){var n=getHTTPObject();if(!n)return!1;displayAjaxLoading(t);for(var r,a=[],i=0;i<e.elements.length;i++)r=e.elements[i],a[i]=r.name+"="+encodeURIComponent(r.value);var l=a.join("&");return n.open("POST",e.getAttribute("action"),!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status||0==n.status){var e=n.responseText.match(/<article>([\s\S]+)<\/article>/);e.length>0?t.innerHTML=e[1]:t.innerHTML="<p>0ops, there was an error. Sorry.</p>"}else t.innerHTML="<p>"+n.statusText+"</p>"},n.send(l),!0}addLoadEvent(highlightPage),addLoadEvent(prepareSlideshow),addLoadEvent(prepareInternalnav),addLoadEvent(prepareGallery),addLoadEvent(preparePlaceholder),addLoadEvent(stripeTables),addLoadEvent(highlightRows),addLoadEvent(displayAbbreviations),addLoadEvent(focusLabels),addLoadEvent(prepareForms);